
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /users/{userId} {
      // Allow user to create their own document on registration.
      allow create: if request.auth != null && request.auth.uid == userId;

      // Allow user to read and update their own data for OS selection.
      allow read, update: if request.auth != null && request.auth.uid == userId;
      
      // Allow only the root user (by email) to list all users.
      // In a production app, it is more secure to use the UID for this check.
      allow list: if request.auth != null && request.auth.token.email == 'alqorniu552@gmail.com';
    }
  }
}
